{
  "hash": "ab773f725f2c2e154787473ca1f133b5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Finding the Best Waters\"\ndescription: \"Mapping Aquaculture Potential Along the U.S. West Coast\"\nauthor: \n  - name: Lucian Blue Scher\n    url: https://lucianbluescher.github.io\n    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB) \n    affiliation-url: https://ucsb-meds.github.io/ \ndate: 12-12-2025\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    theme: cosmo\n    code-fold: true\n    code-summary: \"Show code\"\ncategories: [Aquaculture, Marine Science, Geospatial, MEDS, R]\nimage: images/clipboard-754817526.png\neditor_options: \n  chunk_output_type: inline\n---\n\n![](images/clipboard-754817526.png)\nImage Credits: [Jane March, The Road Ahead for Sustainable Aquaculture](https://earth.org/sustainable-aquaculture/)\n\n## The Challenge: Where Should We Farm the Ocean?\n\nAs global demand for seafood continues to rise, aquaculture—the farming of aquatic organisms—has emerged as a critical solution to meet nutritional needs while reducing pressure on wild fish stocks. But not all ocean waters are created equal. Marine species have specific environmental requirements, and identifying optimal farming locations requires careful spatial analysis of oceanographic conditions.\n\n**This analysis addresses a key question: Which U.S. West Coast Exclusive Economic Zone (EEZ) offers the most suitable habitat for commercially important shellfish species?**\n\nBy combining sea surface temperature data, ocean depth measurements, and exclusive economic zone boundaries (EEZ), we can pinpoint the regions where aquaculture operations would have the greatest chance of success.\n\n## Why This Matters\n\nAquaculture is the fastest-growing food production sector globally, now accounting for over half of all fish consumed worldwide (FAO, 2022). Along the U.S. West Coast, shellfish farming represents a sustainable industry that provides economic benefits to coastal communities while offering ecosystem services like water filtration and habitat creation.\n\nHowever, the success of aquaculture operations depends heavily on site selection. Species like oysters and abalone have narrow tolerance ranges for temperature and depth. Farming outside these optimal conditions leads to increased mortality, slower growth rates, and economic losses. Climate change further complicates this picture, as shifting ocean temperatures may alter which regions remain viable for specific species (Froehlich et al., 2018).\n\nUnderstanding current habitat suitability is therefore essential for:\n\n-   **Industry planning**: Guiding investment decisions for aquaculture operations\n-   **Regulatory management**: Informing marine spatial planning within EEZs\n-   **Climate adaptation**: Establishing baselines to track future habitat shifts\n\n## Data Sources\n\nThis analysis integrates three primary datasets:\n\n| Dataset | Source | Description |\n|----------------------|--------------------|------------------------------|\n| **Sea Surface Temperature** | NOAA | Average annual SST rasters (2008-2012) |\n| **Bathymetry** | General Bathymetric Chart of the Oceans (GEBCO) | Ocean depth measurements |\n| **Exclusive Economic Zones** | Marine Regions | West Coast EEZ boundary polygons |\n\nSpecies-specific temperature and depth requirements were obtained from [SeaLifeBase](https://www.sealifebase.ca/search.php), a global database of marine life information.\n\n\n::: {.cell}\n\n:::\n\n\n## The Approach: Habitat Suitability Modeling\n\nThe analysis follows a systematic workflow that identifies suitable aquaculture locations. Let's break it down step by step using the Rock scallop (*Crassedoma giganteum*) as an example. The Rock scallop prefers temperate water temperatures of about **13–22°C** and shallower waters down to **45 meters**.\n\n1.  **Define species requirements**: Set suitable sea surface temperature (°C) and depth ranges (m). Then identify the input layers (SST rasters, depth rasters, EEZ polygons). This anchors all further processing to the species’ physiological needs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspecies_name <- \"Rock scallop\"\nsst_min <- 13; sst_max <- 22      # acceptable SST in °C\ndepth_min <- -45; depth_max <- 0 # acceptable depth in m\nsst_data <- mean_sst               # sea surface temperature raster\ndepth_data <- depth_resampled      # depth raster\neez_data <- eez                    # EEZ polygons\n```\n:::\n\n\n2.  **Reclassify environmental layers**: Use reclassification matrices to convert continuous SST and depth into binary masks: values inside the acceptable range get a 1 (suitable) and everything else a 0 (unsuitable). For SST, the matrix maps anything below sst_min or above sst_max to 0, and values between to 1; for depth, the matrix does the same with depth_min and depth_max. Calling classify() with these matrices produces yes/no suitability rasters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsst_rcl <- matrix(c(-Inf, sst_min, 0,\n                    sst_min, sst_max, 1,\n                    sst_max, Inf, 0),\n                  ncol = 3, byrow = TRUE)\ndepth_rcl <- matrix(c(-Inf, depth_min, 0,\n                      depth_min, depth_max, 1,\n                      depth_max, Inf, 0),\n                    ncol = 3, byrow = TRUE)\n\nsst_bin   <- classify(sst_data, rcl = sst_rcl)\ndepth_bin <- classify(depth_data, rcl = depth_rcl)\ndepth_stack <- rep(depth_bin, nlyr(sst_bin))  # match layers\n```\n:::\n\n\n3.  **Overlay analysis**: Combine the SST and depth masks to keep only cells that satisfy *both* criteria. The product of the two binary layers identifies candidate habitat cells.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuitable_cells <- lapp(c(sst_bin, depth_stack),\n                       fun = function(sst, depth) sst * depth)\n```\n:::\n\n\n4.  **Zonal statistics**: Quantify suitable area by EEZ. Align projections, mask suitability to EEZ boundaries, convert EEZ polygons to a raster of IDs, multiply suitability by cell area (km²), and sum within each zone. This produces a ranked table of suitable area per EEZ, turning raster cells of suitability into regional metrics that we can visualize.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neez_data <- st_transform(eez_data, crs(suitable_cells))\nsuitable_masked <- mask(suitable_cells, vect(eez_data))\neez_rast <- rasterize(vect(eez_data), suitable_masked[[1]], field = \"rgn\")\ncell_area <- cellSize(suitable_masked, unit = \"km\")\nsuitable_area_rast <- suitable_masked * cell_area\ntotal_area_per_eez <- zonal(suitable_area_rast, eez_rast, fun = \"sum\", na.rm = TRUE)\ncolnames(total_area_per_eez) <- c(\"Region\", \"Suitable Area (km2)\")\nranked_eez <- total_area_per_eez[order(-total_area_per_eez$\"Suitable Area (km2)\"), ]\n```\n:::\n\n\n5.  **Visualization**: Join the computed suitable area back to the EEZ polygons and map the results. The map shades EEZs by suitable area (km²), adds basemap context, and labels regions for clear regional comparison of habitat suitability.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neez_data$\"Suitable Area (km2)\" <- setNames(ranked_eez$\"Suitable Area (km2)\",\n                                           ranked_eez$Region)[eez_data$rgn]\n\nland <- ne_countries(scale = \"medium\", returnclass = \"sf\")\neez_bbox <- st_bbox(eez_data)\neez_bbox[c(\"xmin\", \"ymin\")] <- eez_bbox[c(\"xmin\", \"ymin\")] - 2\neez_bbox[c(\"xmax\", \"ymax\")] <- eez_bbox[c(\"xmax\", \"ymax\")] + 2\nland_cropped <- st_crop(land, eez_bbox)\n\ntm_shape(land_cropped) +\n  tm_polygons(fill = \"lightgray\", col = \"black\", lwd = 1) +\n  tm_shape(eez_data) +\n  tm_polygons(fill = \"Suitable Area (km2)\",\n              fill.scale = tm_scale_continuous(values = \"brewer.yl_or_rd\"),\n              fill.legend = tm_legend(title = \"Suitable Area (km²)\"),\n              col = \"black\", lwd = 0.5) +\n  tm_text(\"rgn\", size = 0.4, col = \"black\", fontface = \"bold\",\n          remove.overlap = TRUE, auto.placement = TRUE) +\n  tm_title(text = paste(\"Suitable Aquaculture Habitat:\", species_name),\n           size = 0.7, fontface = \"bold\") +\n  tm_scalebar(position = c(\"left\", \"bottom\")) +\n  tm_compass(position = c(\"right\", \"top\")) +\n  tm_layout(legend.outside = TRUE, legend.outside.position = \"right\")\n```\n\n::: {.cell-output-display}\n![Suitability for Rock scallop aquaculture across West Coast EEZs. Southern California is the most suitable region for this species.](index_files/figure-html/Rock-scallop-1.png){width=672}\n:::\n:::\n\n\n**Key Finding**: Due to the Rock scallops warmer temperature preference, Southern California is shown to have the most suitable area for Rock scallop aquaculture.\n\n## Creating a Function\n\nThat workflow works great for identifying suitable aquaculture locations for an individual species, but it takes a lot of code. By combining each step into a function, additional species can be analyzed in one line of code, determining their most suitable zone quickly to aid in site selection. Included here is the function code that replaces the first step with suitability parameters and a [Roxygen](https://roxygen2.r-lib.org/) skeleton to provide function documentation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#' @title Mapping Potential Aquaculture for species in West Coast Exclusive Economic Zones\n#' @author Lucian Scher\n#' @param species_name Name of species (Scientific or Common)\n#' @param sst_min Minimum of temperature range (Degrees Celsius)\n#' @param sst_max Maximum of temperature range (Degrees Celsius)\n#' @param depth_min Minimum of depth range negative for underwater (Meters)\n#' @param depth_max Maximum of depth range 0 for sea-level (Meters)\n#' *Optional Parameters:* to update SST, depth or EEZ data in case of changes: \n#' Default is data used this repository. \n#' Will need to re-prepare and re-process if neccessary to change these.\n#' @param sst_data Sea Surface Temperature Data\n#' @param depth_data Bathymetry data\n#' @param eez_data Exclusive Economic Zones\n#'\n#' @returns Map of EEZ regions colored by amount of suitable area for given species \n#' (species name included in map title)\n\n#| label: suitability-function\n\n# 1.  Define species requirements\nmap_species_suitability <- function(species_name, \n                                     sst_min, sst_max, \n                                     depth_min, depth_max,\n                                     sst_data = mean_sst,\n                                     depth_data = depth_resampled,\n                                     eez_data = eez) {\n  \n# 2.  Reclassify environmental layers\n  \n  sst_rcl <- matrix(c(-Inf, sst_min, 0, sst_min, sst_max, 1, sst_max, Inf, 0), \n                    ncol = 3, byrow = TRUE)\n  depth_rcl <- matrix(c(-Inf, depth_min, 0, depth_min, depth_max, 1, depth_max, Inf, 0), \n                      ncol = 3, byrow = TRUE)\n  \n  # Reclassify to binary suitability\n  sst_bin <- classify(sst_data, rcl = sst_rcl)\n  depth_bin <- classify(depth_data, rcl = depth_rcl)\n  depth_stack <- rep(depth_bin, nlyr(sst_bin))\n  \n# 3.  Overlay analysis\n  # Identify suitable cells\n  suitable_cells <- lapp(c(sst_bin, depth_stack), \n                         fun = function(sst, depth) sst * depth)\n  \n# 4.  Zonal statistics\n  \n  # Match CRS\n  eez_data <- st_transform(eez_data, crs(suitable_cells))\n  \n  # Mask to EEZ and rasterize\n  suitable_masked <- mask(suitable_cells, vect(eez_data))\n  eez_rast <- rasterize(vect(eez_data), suitable_masked[[1]], field = \"rgn\")\n  \n  # Calculate suitable area per EEZ\n  cell_area <- cellSize(suitable_masked, unit = \"km\")\n  suitable_area_rast <- suitable_masked * cell_area\n  total_area_per_eez <- zonal(suitable_area_rast, eez_rast, fun = \"sum\", na.rm = TRUE)\n  \n   # Change Column names for mapping\n  colnames(total_area_per_eez) <- c(\"Region\", \"Suitable Area (km2)\")\n  \n  # Order largest to smallest\n  ranked_eez <- total_area_per_eez[order(-total_area_per_eez$\"Suitable Area (km2)\"), ]\n  # Round up decimals\n  ranked_eez$\"Suitable Area (km2)\" <- round(ranked_eez$\"Suitable Area (km2)\", 1)\n  \n# 5.  Visualization\n  \n  # Add suitable area to EEZ polygons\n  eez_data$\"Suitable Area (km2)\" <- setNames(ranked_eez$\"Suitable Area (km2)\",                 ranked_eez$Region)[eez_data$rgn]\n  \n   # Get land polygons cropped to EEZ extent with buffer\n  land <- ne_countries(scale = \"medium\", returnclass = \"sf\")\n  eez_bbox <- st_bbox(eez_data)\n  eez_bbox[c(\"xmin\", \"ymin\")] <- eez_bbox[c(\"xmin\", \"ymin\")] - 2\n  eez_bbox[c(\"xmax\", \"ymax\")] <- eez_bbox[c(\"xmax\", \"ymax\")] + 2\n  land_cropped <- st_crop(land, eez_bbox)\n  \n   # Create and display map\n  map <- tm_shape(land_cropped) +\n    tm_polygons(fill = \"lightgray\", col = \"black\", lwd = 1) +\n    tm_shape(eez_data) +\n    tm_polygons(fill = \"Suitable Area (km2)\", \n                fill.scale = tm_scale_continuous(values = \"brewer.yl_or_rd\"),\n                fill.legend = tm_legend(title = \"Suitable Area (km²)\"),\n                col = \"black\", lwd = 0.5) +\n    tm_text(\"rgn\", size = 0.4, col = \"black\", fontface = \"bold\", \n            remove.overlap = TRUE, auto.placement = TRUE) +\n    tm_title(text = paste(\"Suitable Aquaculture Habitat:\", species_name), \n             size = 0.7, fontface = \"bold\") +\n    tm_scalebar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\")) +\n    tm_layout(legend.outside = TRUE, legend.outside.position = \"right\")\n  \n  print(map)\n  return(invisible(map))\n}\n```\n:::\n\n\n## Results\n\nFunction testing on three different species.\n\n### Case Study 1: Oysters (General)\n\nOysters (*Crassostrea* spp.) are among the most economically important aquaculture species on the West Coast. They thrive in waters with temperatures between **11–30°C** and depths from the surface down to **70 meters**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_species_suitability(\"Oysters\", sst_min = 11, sst_max = 30, \n                        depth_min = -70, depth_max = 0)\n```\n\n::: {.cell-output-display}\n![Habitat suitability for oyster aquaculture across West Coast EEZs. Central California emerges as the region with the greatest suitable area.](index_files/figure-html/fig-oysters-1.png){#fig-oysters width=672}\n:::\n:::\n\n\n**Key Finding**: Central California offers the most extensive suitable habitat for general oyster farming, with its combination of moderate temperatures and extensive shallow coastal waters.\n\n------------------------------------------------------------------------\n\n### Case Study 2: Olympia Oysters (*Ostrea lurida*)\n\nThe Olympia oyster is the only oyster species native to the West Coast and has significant ecological and cultural value. However, it has much narrower temperature requirements (**10–12°C**) compared to other oyster species but similar depths (down to **71 meters**).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_species_suitability(\"Olympia Oysters\", sst_min = 10, sst_max = 12, \n                        depth_min = -71, depth_max = 0)\n```\n\n::: {.cell-output-display}\n![Habitat suitability for Olympia oyster aquaculture. Washington's cooler waters provide the most suitable conditions for this native species.](index_files/figure-html/fig-olympia-1.png){#fig-olympia width=672}\n:::\n:::\n\n\n**Key Finding**: Washington emerges as the optimal region for Olympia oyster restoration and aquaculture efforts, reflecting the species' preference for cooler northern waters.\n\n------------------------------------------------------------------------\n\n### Case Study 3: Red Abalone (*Haliotis rufescens*)\n\nRed abalone are prized for their meat and shells but have experienced dramatic population declines due to overharvesting and disease. They prefer temperatures between **8–18°C** and shallower depths (down to **24 meters**).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_species_suitability(\"Red Abalone\", sst_min = 8, sst_max = 18, \n                        depth_min = -24, depth_max = 0)\n```\n\n::: {.cell-output-display}\n![Habitat suitability for red abalone aquaculture. Washington provides the largest area of suitable habitat based on temperature and depth requirements.](index_files/figure-html/fig-abalone-1.png){#fig-abalone width=672}\n:::\n:::\n\n\n**Key Finding**: Washington's cooler waters and suitable bathymetry make it the most promising region for red abalone aquaculture development.\n\n## Conclusions\n\nThis analysis reveals distinct spatial patterns in aquaculture suitability across the West Coast:\n\n| Species           | Optimal EEZ        | Temperature Range | Depth Range |\n|-------------------|--------------------|-------------------|-------------|\n| Oysters (general) | Central California | 11–30°C           | 0–70m       |\n| Olympia Oyster    | Washington         | 10–12°C           | 0–71m       |\n| Red Abalone       | Washington         | 8–18°C            | 0–24m       |\n\n**Washington's cooler waters make it particularly valuable for temperature-sensitive species**, while Central California's warmer and more extensive shallow areas favor species with broader thermal tolerance.\n\n### Limitations & Future Directions\n\nThis analysis provides a useful first approximation, but several factors warrant consideration:\n\n-   **Temporal variability**: SST data represents a 5-year average (2008–2012); seasonal and interannual variability could affect site-specific suitability\n-   **Additional parameters**: Factors like salinity, chlorophyll concentration, current patterns, and substrate type also influence aquaculture success\n-   **Climate projections**: Future analyses should incorporate climate model projections to assess long-term viability\n-   **Regulatory constraints**: Not all suitable areas may be available for aquaculture due to existing uses or protected status\n\nDespite these limitations, spatial habitat suitability modeling provides an essential foundation for sustainable aquaculture development along the West Coast.\n\n## References\n\nFAO. (2022). *The State of World Fisheries and Aquaculture 2022: Towards Blue Transformation*. Food and Agriculture Organization of the United Nations. https://www.fao.org/publications/sofia/2022/en/\n\nFroehlich, H. E., Gentry, R. R., & Halpern, B. S. (2018). Global change in marine aquaculture production potential under climate change. *Nature Ecology & Evolution*, 2(11), 1745–1750. https://doi.org/10.1038/s41559-018-0669-1\n\nSeaLifeBase. (2024). *Ostrea lurida* (Olympia oyster). https://www.sealifebase.ca/summary/Ostrea-lurida.html\n\nSeaLifeBase. (2024). *Haliotis rufescens* (Red abalone). https://www.sealifebase.ca/summary/Haliotis-rufescens.html\n\nSeaLifeBase. (2025). *Crassedoma giganteum* (Rock scallop). https://www.sealifebase.ca/summary/Crassedoma-giganteum.html\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}