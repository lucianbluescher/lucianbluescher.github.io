{
  "hash": "a76c883d8046aa1fc9914e94b7ea0157",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"LA Fires\"\ndescription: \"Remote sensing and equity insights for the 2025 Eaton and Palisades wildfires.\"\nauthor: \n  - name: Lucian Blue Scher\n    url: https://lucianbluescher.github.io\n    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB) \n    affiliation-url: https://ucsb-meds.github.io/ \ndate: 12-12-2025\ncategories: [MEDS, R, Python]\nimage: images/landsat_false_perimeter.png\nbibliography: references.bib\ncode-fold: true\neditor_options: \n  chunk_output_type: inline\njupyter: eds220-env\nexecute:\n  kernel: eds220-env\n  python:\n    path: /opt/anaconda3/envs/eds220-env/bin/python\n---\n\n[Full analysis on GitHub](https://github.com/lucianbluescher/eds220-hwk4)\n\n# About\n\nThe [Eaton](https://en.wikipedia.org/wiki/Eaton_Fire) and [Palisades](https://en.wikipedia.org/wiki/Palisades_Fire) Fires reshaped large swaths of the Los Angeles foothills in early 2025. In this post we go through a remote-sensing workflow that converts Landsat 8 surface reflectance into true and false-color composite maps, overlays official fire perimeters, and links the impacted footprints to poverty data from the EPA’s Environmental Justice Index (EJI) to highlight economically vulnerable census tracts caught within the burn scars, and identify an environmental injustice if it exists.\n\n## Highlights\n\n-   Fire perimeter processing and Landsat feature wrangling using `pandas`, `geopandas`, `numpy`, and `xarray`.\n-   Raster manipulation to align raster and vector data.\n-   True and false color visualization with `matplotlib`.\n-   Environmental Justice Index joins comparing poverty inside each fire footprint.\n\n## About the Data\n\nIn this notebook we use three datasets:\n\n**1) Palisades & Eaton fire perimeters (Los Angeles County NIFC)**\n\nThe first dataset contains fire perimeter polygons delineating burn footprints for the Palisades and Eaton wildfires of 2025. It comes from the FIRIS (Fire Integrated Real-time Intelligence System) infrared aicraft system in collaboration with the NIFC (National Interagency Fire Center. The data was accessed 2025-12-22 from [ArcGIS Online](https://egis-lacounty.hub.arcgis.com/maps/ad51845ea5fb4eb483bc2a7c38b2370c/about). For this analysis we use just the .shp file in the folder.\n\n**2) Landsat 8 Collection 2 Level-2 surface reflectance**\n\nThe second dataset is a NetCDF containing multispectral surface reflectance information from (RGB, NIR, SWIR) from the Landsat 8 satellite. This data was downloaded from [Microsoft Planetary Computer](https://planetarycomputer.microsoft.com/dataset/landsat-c2-l2) on 2025-11-22, and is read as an xarrayDataset.\n\nWe use five bands in our analysis:\n\n-   Red/Green/Blue (Bands 4/3/2): true-color composites.\n\n-   Near-Infrared (NIR08 - Band 5): vegetation response.\n\n-   Short-Wave Infrared (SWIR22 Bands 6/7): moisture/char sensitivity, used to highlight burn scars via false-color composites.\n\n**3) Environmental Justice Index (EJI)**\n\nThe final dataset we use is the census tract-level poverty indicator sourced from the 2018–2022 [Census Bureau American Community Survey (ACS) 5-year data](https://www.census.gov/data/developers/data-sets/acs-5year.html) and downloaded from the [Agency for Toxic Substances and Disease Registry](https://www.atsdr.cdc.gov/place-health/php/eji/eji-data-download.html). We use the \"E_POV200\" variable defined in the metadata as “Percentage of persons with income below 200% of the federal poverty level” to map socioeconomic vulnerability in tracts intersecting the fire perimeters.\n\n## References\n\nBackground information and Landsat band combinations:\n\n\\[1\\] Why is that Forest Red and That Cloud Blue? (2014, March 4). Nasa.gov; NASA Earth Observatory. https://earthobservatory.nasa.gov/features/FalseColor\n\n\\[2\\] What are the band designations for the Landsat satellites? (2025, July 11). USGS. https://www.usgs.gov/faqs/what-are-band-designations-landsat-satellites\n\n\\[3\\] Common Landsat Band Combinations. (2021, November 12). USGS. https://www.usgs.gov/media/images/common-landsat-band-combinations\n\n## Final output\n\nThis notebook produces this final output of poverty levels in each fires burn area.\n\n![](images/final-output.png){fig-alt=\"False color map of the Los Angeles area highlighting Eaton and Palisades fire perimeters\"}\n\n## Import libraries\n\n::: {#adfbbb43 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport os\nimport geopandas as gpd\nimport xarray as xr\n\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nimport contextily as ctx\n```\n:::\n\n\n## Import data\n\n::: {#4030e603 .cell execution_count=2}\n``` {.python .cell-code}\n# Eaton fire perimeter\nfp = os.path.join('data', 'Eaton_Perimeter_20250121', 'Eaton_Perimeter_20250121.shp')\neaton = gpd.read_file(fp)\n\n# Palisades fire perimeter\nfp = os.path.join('data', 'Palisades_Perimeter_20250121', 'Palisades_Perimeter_20250121.shp')\npalisades = gpd.read_file(fp)\n\n# Landsat 8\nlandsat = xr.open_dataset(\n    \"data/landsat8-2025-02-23-palisades-eaton.nc\")\n    \n# Environmental Justice Index\neji = gpd.read_file(\"data/EJI_2024_California/EJI_2024_California.gdb\")\n```\n:::\n\n\n## Prepare perimeter data\n\nWe start by verifying the coordinate reference system (CRS) of perimeter data and check that both are projected.\n\n::: {#9f7f5b06 .cell execution_count=3}\n``` {.python .cell-code}\n# Fire perimeter data exploration\nprint(f\"The CRS for the Eaton Perimeter is {eaton.crs}\")\nprint(f\"The CRS for the Palisades Perimeter is {palisades.crs}\")\nprint(f\"The Eaton Perimeter is projected: {eaton.crs.is_projected}\")\nprint(f\"The Palisades Perimeter is projected: {palisades.crs.is_projected}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe CRS for the Eaton Perimeter is EPSG:3857\nThe CRS for the Palisades Perimeter is EPSG:3857\nThe Eaton Perimeter is projected: True\nThe Palisades Perimeter is projected: True\n```\n:::\n:::\n\n\nBoth perimeters share a projected CRS and schema.\n\nBefore we move on lets check for no-data values in our landsat raster and remove them if they exist, confirming with an `assert`.\n\n::: {#0065aee4 .cell execution_count=4}\n``` {.python .cell-code}\n# Fill NaNs with zero if any\nif landsat.to_array().isnull().any():\n    landsat = landsat.fillna(0)\n\n# Assert no NaNs remain\nassert not landsat.to_array().isnull().any(), \"NaNs remain after fill.\"\n```\n:::\n\n\n## Prepare Landsat 8 data\n\nLandsat arrives as an xarray.Dataset with georeferencing stored in `spatial_ref`. Because `xarray` sometimes drops CRS info, we explicitly write it back so raster/vector overlays align perfectly.\n\n::: {#df68860e .cell execution_count=5}\n``` {.python .cell-code}\n# Get the CRS of landsat\nlandsat_crs = landsat.spatial_ref.crs_wkt\n\n# Recover the geospatial information by using rio.write_crs() \nlandsat = landsat.rio.write_crs(landsat_crs)\n\n# Print the CRS of the updated dataset.\nprint(landsat.rio.crs)\n\n# Let's also match our fire perimeter data to the landsat crs\npalisades = palisades.to_crs(landsat.rio.crs)\neaton     = eaton.to_crs(landsat.rio.crs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEPSG:32611\n```\n:::\n:::\n\n\n## True-color image rendering\n\nIn order to visualize the burned areas we build a true-color Landsat image by stacking the red, green, and blue bands, then filling no-data again to be certain. Casting to a float ensures safe color scaling.\n\n::: {#f9e64d14 .cell execution_count=6}\n``` {.python .cell-code}\n# Build and clean RGB\nrgb = landsat[[\"red\", \"green\", \"blue\"]].to_array()\nrgb = rgb.where(np.isfinite(rgb), 0).astype(float)\n\nfig, ax = plt.subplots(figsize=(8, 8))\n_ = rgb.plot.imshow(\n    ax=ax,\n    vmin=8200, vmax=13500,\n    robust=True,\n    add_colorbar=False\n)\n\n# Overlays\npalisades.boundary.plot(ax=ax, color=\"red\", linewidth=1)\neaton.boundary.plot(ax=ax, color=\"red\", linewidth=1)\n\n# Labels\np_center = palisades.geometry.centroid.iloc[0]\ne_center = eaton.geometry.centroid.iloc[0]\ndx, dy = 100, -5000\nax.text(p_center.x + dx, p_center.y + dy, \"Palisades Fire\",\n        color=\"black\", fontsize=10, ha=\"left\", va=\"center\",\n        bbox=dict(facecolor=\"white\", edgecolor=\"black\", boxstyle=\"round,pad=0.2\", alpha=0.8))\nax.text(e_center.x + dx, e_center.y + dy, \"Eaton Fire\",\n        color=\"black\", fontsize=10, ha=\"left\", va=\"center\",\n        bbox=dict(facecolor=\"white\", edgecolor=\"black\", boxstyle=\"round,pad=0.2\", alpha=0.8))\n\n# Lock view to the raster extent \nax.set_xlim(float(rgb.x.min()), float(rgb.x.max()))\nax.set_ylim(float(rgb.y.min()), float(rgb.y.max()))\n\nax.set_title(\"Landsat True Color (Palisades/Eaton)\", fontsize=12, fontweight=\"bold\")\nax.set_axis_off()\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-7-output-1.png){width=758 height=421}\n:::\n:::\n\n\nDespite stretching the colormap (vmin=8200, vmax=13500) to more clearly show burn scars, they still appear as subtle dark patches against the surrounding vegetation, let's try a false-color map.\n\n## False-Color image rendering\n\nA false-color rendering remaps bands to emphasize burn severity:\n\n- SWIR22 as red \n\n- NIR08 as green\n\n- Red as blue. \n\nThis makes burned areas stand out more clearly. We then reproject the fire perimeters to the Landsat CRS, overlay them in red, and label each fire so the false-color composite directly highlights where and how severely the Palisades and Eaton fires affected the landscape.\n\n::: {#ca58a113 .cell execution_count=7}\n``` {.python .cell-code}\n# Build false-color stack (SWIR–NIR–Red)\nfci = landsat[[\"swir22\", \"nir08\", \"red\"]].to_array()\nfci = fci.where(np.isfinite(fci), 0).astype(float)\n\nfig, ax = plt.subplots(figsize=(8, 8))\n_ = fci.plot.imshow(\n    ax=ax,\n    vmin=7000,\n    vmax=15000,\n    robust=True,\n    add_colorbar=False\n)\n\n# Overlays\npalisades.boundary.plot(ax=ax, color=\"red\", linewidth=1)\neaton.boundary.plot(ax=ax, color=\"red\", linewidth=1)\n\n# Labels\np_center = palisades.geometry.centroid.iloc[0]\ne_center = eaton.geometry.centroid.iloc[0]\ndx, dy = 100, -5000\nax.text(p_center.x + dx, p_center.y + dy, \"Palisades Fire\",\n        color=\"black\", fontsize=10, ha=\"left\", va=\"center\",\n        bbox=dict(facecolor=\"white\", edgecolor=\"black\", boxstyle=\"round,pad=0.2\", alpha=0.8))\nax.text(e_center.x + dx, e_center.y + dy, \"Eaton Fire\",\n        color=\"black\", fontsize=10, ha=\"left\", va=\"center\",\n        bbox=dict(facecolor=\"white\", edgecolor=\"black\", boxstyle=\"round,pad=0.2\", alpha=0.8))\n\n# Lock view to raster extent\nax.set_xlim(float(fci.x.min()), float(fci.x.max()))\nax.set_ylim(float(fci.y.min()), float(fci.y.max()))\n\nax.set_title(\"Landsat False Color (Palisades/Eaton)\", fontsize=12, fontweight=\"bold\")\nax.set_axis_off()\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-8-output-1.png){width=758 height=421}\n:::\n:::\n\n\nSWIR–NIR–red composites render burned areas in red hues and healthy vegetation in greens, so the perimeter overlays become immediately interpretable.\n\n# EJI analysis\n\nNow we will build tract-level subsets for each fire perimeter to map E_POV200 (percent of persons below 200% of federal poverty level). The goal is to see whether high-poverty census tracts overlap the Palisades and Eaton fire footprints.\n\nFirst we need to match the CRS of our EJI data to our fire perimeters.\n\n::: {#fff463a7 .cell execution_count=8}\n``` {.python .cell-code}\neji = eji.to_crs(palisades.crs)\nassert eji.crs == eaton.crs\n```\n:::\n\n\n## Merging\n`GeoPandas` Spatial joins `sjoin` isolates the tracts intersecting each fire perimeter. \n\n::: {#e299f920 .cell execution_count=9}\n``` {.python .cell-code}\n# EJI tracts overlapping Palisades\neji_pali = gpd.sjoin(\n    eji, palisades[[\"geometry\"]],\n    how=\"inner\", predicate=\"intersects\"\n).drop(columns=[\"index_right\"])\n\n# EJI tracts overlapping Eaton\neji_eat = gpd.sjoin(\n    eji, eaton[[\"geometry\"]],\n    how=\"inner\", predicate=\"intersects\"\n).drop(columns=[\"index_right\"])\n```\n:::\n\n\n## Clipping\n`GeoPandas` clipping cuts the tracts to the fire perimeter boundary vector lines. Think cookie cutting. \n\n::: {#c3d9e84e .cell execution_count=10}\n``` {.python .cell-code}\n# Clip EJI to Palisades\npalisades_clip = gpd.clip(eji_pali, palisades)\n\n# Clip EJI to Eaton\neaton_clip = gpd.clip(eji_eat, eaton)\n```\n:::\n\n\n## Final visualition\n\nLastly, we compare poverty exposure for the tracts inside each perimeter. The goal of this map is too compare the census tracts within each fire boundary and determine if there is economic injustice within either area.\n\n::: {#068bda4b .cell execution_count=11}\n``` {.python .cell-code}\neji_variable = \"E_POV200\"\nvmin = min(palisades_clip[eji_variable].min(), eaton_clip[eji_variable].min())\nvmax = max(palisades_clip[eji_variable].max(), eaton_clip[eji_variable].max())\ncmap = mpl.colormaps[\"YlGnBu\"]\n\nfig, (ax1, ax2) = plt.subplots(\n    1, 2, figsize=(9, 6.5), constrained_layout=True\n)\n\n# Palisades\npalisades_clip.plot(\n    column=eji_variable, cmap=cmap, vmin=vmin, vmax=vmax,\n    linewidth=0.4, edgecolor=\"0.6\", legend=False, ax=ax1\n)\nax1.set_title(\"Palisades Fire Area\", fontsize=13, fontweight=\"bold\")\nax1.axis(\"off\")\n\n# Eaton\neaton_clip.plot(\n    column=eji_variable, cmap=cmap, vmin=vmin, vmax=vmax,\n    linewidth=0.4, edgecolor=\"0.6\", legend=False, ax=ax2\n)\nax2.set_title(\"Eaton Fire Area\", fontsize=13, fontweight=\"bold\")\nax2.axis(\"off\")\n\n# Color bar\nsm = mpl.cm.ScalarMappable(norm=mpl.colors.Normalize(vmin=vmin, vmax=vmax), cmap=cmap)\ncbar = fig.colorbar(sm, ax=[ax1, ax2], orientation=\"horizontal\", fraction=0.05, pad=0.05)\ncbar.set_label(\"Percent of persons below 200% of the federal poverty level\", fontsize=11)\n\n# Titles\nfig.suptitle(\"Poverty in Census Tracts within Palisades and Eaton Fire perimeters\",\n             fontsize=15, fontweight=\"bold\", y=0.75)\nfig.text(0.5, 0.70,\n         \"Census tracts are clipped to fire perimeters\",\n         ha=\"center\", va=\"center\", fontsize=11)\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-12-output-1.png){width=875 height=482}\n:::\n:::\n\n\nOverall, neither footprint is dominated by very high‑poverty tracts, but there’s a clear contrast: the Eaton perimeter includes a few tracts with markedly higher poverty shares (darker blues), while the Palisades tracts are mostly midrange to lower. This mirrors Los Angeles’ spatial pattern—more affluent coastal/Westside areas around Palisades versus pockets of higher economic vulnerability farther east—suggesting greater potential EJ concerns within parts of the Eaton area.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}