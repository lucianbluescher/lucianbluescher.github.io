---
title: "LA Fires"
description: "Remote sensing and equity insights for the 2025 Eaton and Palisades wildfires."
author: 
  - name: Lucian Blue Scher
    url: https://lucianbluescher.github.io
    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB) 
    affiliation-url: https://ucsb-meds.github.io/ 
date: 12-12-2025
categories: [MEDS, R, Python]
image: images/landsat_false_perimeter.png
bibliography: references.bib
editor_options: 
  chunk_output_type: inline
jupyter: eds220-env
execute:
  kernel: eds220-env
  python:
    path: /opt/anaconda3/envs/eds220-env/bin/python
---

[Full analysis on GitHub](https://github.com/lucianbluescher/lucianbluescher.github.io/tree/main/posts/220final_LAfires_AZbiodiversity_blog)

## About this Post

The Eaton and Palisades Fires reshaped large swaths of the Los Angeles foothills in early 2025. This post summarizes a remote-sensing workflow that converts Landsat 8 surface reflectance into both true- and false-color composites, overlays official fire perimeters, and links the impacted footprints to the EPA’s Environmental Justice Index (EJI) to highlight socially vulnerable neighborhoods caught within the burn scars.

![](images/landsat_false_perimeter.png){fig-alt="False color map of the Los Angeles area highlighting Eaton and Palisades fire perimeters"}

## Highlights

- Fire perimeter processing and Landsat feature engineering using `pandas`, `geopandas`, `numpy`, and `xarray`.
- CRS restoration and reprojection to align raster and vector assets for accurate overlays.
- True- and false-color visualization with `matplotlib`, emphasizing burn severity via SWIR/NIR combinations.
- Environmental Justice Index joins that compare poverty exposure inside each fire footprint.

## Datasets and References

1. Palisades & Eaton dissolved fire perimeters, Fire Integrated Real-time Intelligence System (FIRIS) via Los Angeles County NIFC ArcGIS Online (accessed 2025-12-22).  
2. Landsat 8 Collection 2 Level-2 surface reflectance (bands: red, green, blue, NIR, SWIR) via Microsoft Planetary Computer; clipped to the study area prior to download (accessed 2025-11-22).  
3. Environmental Justice Index 2024 California geodatabase (EPA).  

Additional background references are listed in `references.bib` (NASA/USGS band guides and Landsat documentation).

## Analysis Overview

### Libraries and Data Ingest

We load the Python libraries used for tabular wrangling, geospatial analysis, and visualization.

```{python}
import pandas as pd
import numpy as np
import os
import geopandas as gpd
import xarray as xr
import matplotlib.pyplot as plt
import contextily as ctx
```

Next we read the Eaton and Palisades perimeter shapefiles plus the clipped Landsat NetCDF scene.

```{python}
fp = os.path.join('~/Desktop/MEDS/lucianbluescher.github.io/posts/220final_LAfires_AZbiodiversity_blog/data/Eaton_Perimeter_20250121/Eaton_Perimeter_20250121.shp')
eaton = gpd.read_file(fp)

fp = os.path.join('~/Desktop/MEDS/lucianbluescher.github.io/posts/220final_LAfires_AZbiodiversity_blog/data/Palisades_Perimeter_20250121/Palisades_Perimeter_20250121.shp')
palisades = gpd.read_file(fp)

landsat = xr.open_dataset("~/Desktop/MEDS/lucianbluescher.github.io/posts/220final_LAfires_AZbiodiversity_blog/data/landsat8-2025-02-23-palisades-eaton.nc", engine="netcdf4")
```

### Quick Data Checks

We verify CRS metadata and inspect the Landsat dimensions/variables so the next steps know what to expect.

```{python}
# Fire perimeter data exploration
print(f"The CRS for the Eaton Perimeter is {eaton.crs}")
print(f"The CRS for the Palisades Perimeter is {palisades.crs}")
print(f"The Eaton Perimeter is projected: {eaton.crs.is_projected}")
print(f"The Palisades Perimeter is projected: {palisades.crs.is_projected}")
eaton.info()
palisades.info()
```

```{python}
# Landsat Exploration
print(landsat.coords) # View coordinates
print(landsat.var) # View Variables
print(landsat.dims) # View Dimensions
```

Both perimeters share a projected CRS and schema, while Landsat arrives as an array with georeferencing stored in `spatial_ref`.

### Restoring Raster CRS Metadata

Because `xarray` sometimes drops CRS info, we explicitly write it back so raster/vector overlays align perfectly.

```{python}
# Check landsat CRS
print(landsat.rio.crs)
```

```{python}
# Print the CRS of landsat
print(landsat.spatial_ref.crs_wkt)
landsat_crs = landsat.spatial_ref.crs_wkt

#Recover the geospatial information by using rio.write_crs() 
landsat = landsat.rio.write_crs(landsat_crs)

#Print the CRS of the updated dataset.#
print(landsat.rio.crs)
```

### True-Color Rendering

We start with a raw RGB composite to establish visual context, then clean nodata values for a clearer view.

```{python}
# Select red, green and blue variables and plot as a numpy.array
landsat[["red", "green", "blue"]].to_array().plot.imshow(vmin = 7000, vmax = 15000)
```

```{python}
# Adjust vmin and max and add robust parameter to get a true color image
landsat[["red", "green", "blue"]].to_array().plot.imshow(vmin = 8200, vmax = 13500, robust = True)
```

```{python}
# Check for nan values in each column
for band in landsat.data_vars:
    print(band, landsat[band].isnull().any().item())
    
```

```{python}
# Identify which values are nan using
np.isnan(landsat)
```

```{python}
# Substitute nan values with 0
landsat = landsat.fillna(0)
```

```{python}
# Check for nan values in each column to ensure it worked
for band in landsat.data_vars:
    print(band, landsat[band].isnull().any().item())
```

```{python}
# Plot new true color image with cleaned array
landsat[["red", "green", "blue"]].to_array().plot.imshow(vmin = 7000, vmax = 15000)
```

The cleaned rendering highlights the burn scars more clearly and keeps the brightness range consistent.

### False-Color Burn Severity Map

We switch to a SWIR–NIR–Red combination to emphasize burned ground versus intact vegetation, then overlay the fire perimeters.

```{python}
# Plot false color image by plotting
landsat[["swir22", "nir08", "red"]].to_array().plot.imshow(vmin = 7000, vmax = 15000)
```

```{python}

# Double check CRS of perimeter data
palisades = palisades.to_crs(landsat.rio.crs)
eaton = eaton.to_crs(landsat.rio.crs)

# Create the false color image from Landsat
fig, ax = plt.subplots(figsize=(10, 10))

landsat[["swir22", "nir08", "red"]].to_array().plot.imshow(
    ax=ax,
    vmin=7000,
    vmax=15000
)

# Plot fire perimeter polygons on top of the  image
palisades.boundary.plot(ax=ax, color="red", linewidth=1)
eaton.boundary.plot(ax=ax, color="red", linewidth=1)

# Set center points of each perimeter
p_center = palisades.geometry.centroid.iloc[0]
e_center = eaton.geometry.centroid.iloc[0]

# Add labels for each fire
ax.text(p_center.x, p_center.y, "Palisades Fire",
        color="black", fontsize=10, 
        ha="left", va="center")

ax.text(e_center.x, e_center.y, "Eaton Fire",
        color="black", fontsize=10,
        ha="right", va="center")

# Add axis labels and title

ax.set_xlabel("X coordinate (meters)")
ax.set_ylabel("Y coordinate (meters)")
ax.set_title("Landsat false color image with Palisades & Eaton Fire Perimeters")

plt.show()
```

SWIR–NIR–red composites render burned areas in red hues and healthy vegetation in greens, so the perimeter overlays become immediately interpretable.

## Environmental Justice Context

We now pull in the Environmental Justice Index (EJI) geodatabase, align CRS, and prepare tract-level subsets for each perimeter.

```{python}
#| tags: []
eji = gpd.read_file("~/Desktop/MEDS/lucianbluescher.github.io/posts/220final_LAfires_AZbiodiversity_blog/data/EJI_2024_California/EJI_2024_California.gdb")
```

```{python}
#| tags: []
eji = eji.to_crs(palisades.crs)
```

```{python}
#| eval: false
#| include: false
#| tags: []
assert eji.crs == eaton.crs
```

```{python}
#| tags: []
eji.crs
```

```{python}
#| tags: []
palisades.crs
```

```{python}
#| tags: []
type(eji)
```

```{python}
#| tags: []
type(palisades)
```

### Tract Selection and Visualization

Spatial joins isolate the tracts intersecting each fire perimeter. We plot them to confirm the selections before moving to poverty metrics.

```{python}
#| tags: []
eji_pali = gpd.sjoin(eji, palisades, predicate = 'intersects')
```

```{python}
#| tags: []
fig, ax = plt.subplots()
    
eji_pali.plot(ax = ax,
                column = 'TRACTCE',
                cmap = 'Dark2',
                legend = True)
    
palisades.plot(ax = ax,
               color = 'none')
plt.show()
```

```{python}
#| tags: []
eji_eat = gpd.sjoin(eji, eaton, predicate = 'intersects')
```

```{python}
#| tags: []
fig, ax = plt.subplots()
    
eji_eat.plot(ax = ax,
                column = 'TRACTCE',
                cmap = 'Dark2',
                legend = True)
    
eaton.plot(ax = ax,
               color = 'none')
plt.show()
```

```{python}
#| tags: []
palisades_clip = gpd.clip(eji_pali, palisades)
eaton_clip = gpd.clip(eji_eat, eaton)
```

```{python}
#| tags: []
fig, ax = plt.subplots()
    
eaton_clip.plot(ax = ax,
                column = 'TRACTCE',
                cmap = 'Dark2',
                legend = True)
    
eaton.plot(ax = ax,
               color = 'none')
plt.show()
```

```{python}
#| tags: []
fig, ax = plt.subplots(1, 1, figsize=(14, 12))

# Add basemap using contextily
ctx.add_basemap(ax, source=ctx.providers.OpenStreetMap.Mapnik)

# ADD FIRE PERIMETERS: UPDATE FILL TRANSPARENCY AND COLOR
eaton.plot(ax = ax,
               color = 'none')

# ADD LEGEND OR ANNOTATION TO IDENTIFY EACH FIRE

# ADD TITLE

ax.axis('off')

plt.tight_layout()
#plt.show()
```

Finally we compare poverty exposure (`E_POV200`) for the tracts inside each perimeter using a shared legend range.

```{python}
#| tags: []
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(30, 10))

# UPDATE WITH YOU EJI VARIABLE FROM STEP 1
eji_variable = 'E_POV200' # percentage of persons with income below 200% of federal poverty level
census_within_palisades = palisades_clip
census_within_eaton = eaton_clip

# Find common min/max for legend range
vmin = min(census_within_palisades[eji_variable].min(), census_within_eaton[eji_variable].min())
vmax = max(census_within_palisades[eji_variable].max(), census_within_eaton[eji_variable].max())

# Plot census tracts within Palisades perimeter
census_within_palisades.plot(
    column= eji_variable,
    vmin=vmin, vmax=vmax,
    legend=False,
    ax=ax1,
)
ax1.set_title('Palisades Fire Area')
ax1.axis('off')

# Plot census tracts within Eaton perimeter
census_within_eaton.plot(
    column=eji_variable,
    vmin=vmin, vmax=vmax,
    legend=False,
    ax=ax2,
)
ax2.set_title('Eaton Fire Area')
ax2.axis('off')

# Add overall title
fig.suptitle('Palisades and Eaton fire comparison - Fire Areas Comparison')

# Add shared colorbar at the bottom
sm = plt.cm.ScalarMappable( norm=plt.Normalize(vmin=vmin, vmax=vmax))
cbar_ax = fig.add_axes([0.25, 0.08, 0.5, 0.02])  # [left, bottom, width, height]
cbar = fig.colorbar(sm, cax=cbar_ax, orientation='horizontal')
cbar.set_label('Percentage of Low income Persons')

plt.show()
```

These joins reveal that both fire scars overlap tracts with elevated poverty scores, underscoring the importance of tailoring recovery resources to vulnerable communities.

## Final Visualizations and Takeaways

1. **True-color Landsat composite** — baseline context for the Angeles National Forest canopy before highlighting change.  
2. **False-color SWIR/NIR composite with perimeter overlays** — pinpoints burn severity differences between Eaton and Palisades.  
3. **EJI poverty comparison plots** — show how each footprint intersects low-income census tracts, guiding equity-focused recovery planning.

After reviewing the visuals, the key takeaway is that burn severity and social vulnerability align across multiple tracts, implying that remote sensing plus equity data should inform targeted mitigation and aid deployment.

